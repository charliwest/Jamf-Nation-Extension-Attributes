<?xml version="1.0" encoding="UTF-8"?>
<extensionAttribute>
	<displayName>Sophos - Virus Definition Version</displayName>
	<displayInCategory>AntiVirus</displayInCategory>
	<description>This attribute returns the Virus Definitions Version for Sophos.  This attribute template applies to Sophos (v 7.1).</description>
	<dataType>integer</dataType>
	<scriptContentsMac>#!/bin/sh
#Check if the version of Sophos is v10 or below for sweep binary location
sweep_binary=$(/usr/bin/which sweep)
if [[ "sweep_binary" == "" ]] && [[ ! -e "/usr/bin/sweep" ]] && [[ -e "/usr/local/bin/sweep" ]]; then
    sweep_binary="/usr/local/bin/sweep"
 elif [[ "sweep_binary" == "" ]] && [[ -e "/usr/local/bin/sweep" ]] && [[ -e "/usr/bin/sweep" ]]; then
    sweep_binary="/usr/bin/sweep"
fi
    
#Check to see if Sophos is installed
if [[ "$sweep_binary" != "" ]]; then
result=$(/usr/bin/sweep --version | grep "Virus data version" | awk '{print $5}')
echo "&lt;result&gt;$result&lt;/result&gt;"
else
echo "&lt;result&gt;Not installed&lt;/result&gt;"
fi
	</scriptContentsMac>
</extensionAttribute>
